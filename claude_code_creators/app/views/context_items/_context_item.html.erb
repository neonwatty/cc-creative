<%= turbo_frame_tag context_item do %>
  <div class="bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow">
    <div class="flex justify-between items-start mb-4">
      <div>
        <h3 class="text-xl font-semibold mb-2">
          <%= link_to context_item.title, document_context_item_path(context_item.document, context_item),
                      class: "text-blue-600 hover:text-blue-800" %>
        </h3>
        <div class="flex items-center space-x-4 text-sm text-gray-600">
          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
            <%= context_item.item_type %>
          </span>
          <span>by <%= context_item.user.name %></span>
          <span><%= context_item.created_at.strftime("%B %d, %Y") %></span>
        </div>
      </div>
      
      <div class="flex space-x-2">
        <%= link_to "Edit", edit_document_context_item_path(context_item.document, context_item),
                    class: "text-sm text-blue-600 hover:text-blue-800",
                    data: { turbo_frame: "edit_context_item_#{context_item.id}" } %>
        <%= button_to "Delete", document_context_item_path(context_item.document, context_item),
                      method: :delete,
                      form: { data: { turbo_confirm: "Are you sure?" } },
                      class: "text-sm text-red-600 hover:text-red-800" %>
      </div>
    </div>
    
    <div class="prose prose-sm max-w-none">
      <%= simple_format(truncate(context_item.content, length: 200)) %>
    </div>
    
    <% if context_item.metadata.present? %>
      <div class="mt-4 p-3 bg-gray-50 rounded text-xs">
        <strong>Metadata:</strong>
        <pre class="mt-1"><%= JSON.pretty_generate(JSON.parse(context_item.metadata)) rescue context_item.metadata %></pre>
      </div>
    <% end %>
  </div>
<% end %>